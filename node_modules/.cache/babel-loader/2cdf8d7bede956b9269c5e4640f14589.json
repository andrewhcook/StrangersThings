{"ast":null,"code":"import _regeneratorRuntime from\"/home/ahc/Bootcamp2022UBUNTU/course_work/NewStrangersThings/StrangersThings/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/ahc/Bootcamp2022UBUNTU/course_work/NewStrangersThings/StrangersThings/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var BASEURL=\"https://strangers-things.herokuapp.com/api/2207-FTB-ET-WEB-PT\";var makeHeaders=function makeHeaders(token){var headers={\"Content-Type\":\"application/json\"};if(token){headers['Authorization']=\"Bearer \".concat(token);}//  console.log(headers);\nreturn headers;};export var apiCall=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(endpoint){var defaultOptions,token,method,body,options,response,result,_args=arguments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:defaultOptions=_args.length>1&&_args[1]!==undefined?_args[1]:{};token=defaultOptions.token,method=defaultOptions.method,body=defaultOptions.body;options={};options.headers=makeHeaders(token);if(method){options.method=method;};if(body){options.body=JSON.stringify(body);}console.log(\"body in apiCall\",options.body);//  console.log(\"options in apiCall\", options);\n_context.next=10;return fetch(\"\".concat(BASEURL,\"/\").concat(endpoint),options);case 10:response=_context.sent;_context.next=13;return response.json();case 13:result=_context.sent;return _context.abrupt(\"return\",result);case 15:case\"end\":return _context.stop();}}},_callee);}));return function apiCall(_x){return _ref.apply(this,arguments);};}();export var fetchPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var token,_yield$apiCall,success,error,data,_args2=arguments;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=_args2.length>0&&_args2[0]!==undefined?_args2[0]:null;_context2.next=3;return apiCall('posts',{token:token,method:\"GET\"});case 3:_yield$apiCall=_context2.sent;success=_yield$apiCall.success;error=_yield$apiCall.error;data=_yield$apiCall.data;if(!success){_context2.next=11;break;}return _context2.abrupt(\"return\",{error:null,posts_value:data.posts});case 11:return _context2.abrupt(\"return\",{error:\"Failed to Load apiCall in fetchPosts\",posts_value:[]});case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchPosts(){return _ref2.apply(this,arguments);};}();export var registerUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(username,password){var _yield$apiCall2,success,error,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return apiCall('users/register',{token:null,method:\"Post\",body:{user:{username:username,password:password}}});case 3:_yield$apiCall2=_context3.sent;success=_yield$apiCall2.success;error=_yield$apiCall2.error;data=_yield$apiCall2.data;if(!success){_context3.next=11;break;}return _context3.abrupt(\"return\",{error:null,token:data.token,mesage:data.message});case 11:return _context3.abrupt(\"return\",{error:error.message,token:null,message:null});case 12:_context3.next=18;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](0);console.error(_context3.t0);return _context3.abrupt(\"return\",{error:\"error in registeredUser() call\",token:null,message:null});case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[0,14]]);}));return function registerUser(_x2,_x3){return _ref3.apply(this,arguments);};}();export var logInUser=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(username,password){var _yield$apiCall3,success,error,data;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return apiCall('users/login',{token:null,method:\"Post\",body:{user:{username:username,password:password}}});case 3:_yield$apiCall3=_context4.sent;success=_yield$apiCall3.success;error=_yield$apiCall3.error;data=_yield$apiCall3.data;if(!success){_context4.next=11;break;}return _context4.abrupt(\"return\",{error:null,token:data.token,mesage:data.message});case 11:alert(\"Incorrect User Credentials\");// console.log(\"no success in registerUser()\", error);\nreturn _context4.abrupt(\"return\",{error:error.message,token:null,message:null});case 13:_context4.next=19;break;case 15:_context4.prev=15;_context4.t0=_context4[\"catch\"](0);console.error(_context4.t0);return _context4.abrupt(\"return\",{error:\"error in registeredUser() call\",token:null,message:null});case 19:case\"end\":return _context4.stop();}}},_callee4,null,[[0,15]]);}));return function logInUser(_x4,_x5){return _ref4.apply(this,arguments);};}();export var isLoggedIn=function isLoggedIn(){var token=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(token){return true;}else{return false;}};export var CreatePost=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(token,post){var _yield$apiCall4,success,error,data;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return apiCall('posts',{token:token,method:\"Post\",body:{post:post}});case 3:_yield$apiCall4=_context5.sent;success=_yield$apiCall4.success;error=_yield$apiCall4.error;data=_yield$apiCall4.data;if(!success){_context5.next=11;break;}return _context5.abrupt(\"return\",{error:null,post:data.post,mesage:data.message});case 11:return _context5.abrupt(\"return\",{error:error.message,post:null,message:null});case 12:_context5.next=18;break;case 14:_context5.prev=14;_context5.t0=_context5[\"catch\"](0);console.error(_context5.t0);return _context5.abrupt(\"return\",{error:\"error in CreatePost() call\",post:null,message:null});case 18:case\"end\":return _context5.stop();}}},_callee5,null,[[0,14]]);}));return function CreatePost(_x6,_x7){return _ref5.apply(this,arguments);};}();export var fetchUser=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(token){var _yield$apiCall5,success,error,data;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return apiCall('users/me',{token:token});case 3:_yield$apiCall5=_context6.sent;success=_yield$apiCall5.success;error=_yield$apiCall5.error;data=_yield$apiCall5.data;if(!success){_context6.next=11;break;}return _context6.abrupt(\"return\",{error:null,userResponse:data,mesage:data.message});case 11:return _context6.abrupt(\"return\",{error:error.message,userResponse:null,message:null});case 12:_context6.next=18;break;case 14:_context6.prev=14;_context6.t0=_context6[\"catch\"](0);console.error(_context6.t0);return _context6.abrupt(\"return\",{error:\"error in FetchUser() call\",userResponse:null,message:null});case 18:case\"end\":return _context6.stop();}}},_callee6,null,[[0,14]]);}));return function fetchUser(_x8){return _ref6.apply(this,arguments);};}();export var DeletePost=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(token,POST_ID){return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return apiCall(\"posts/\".concat(POST_ID),{token:token,method:\"DELETE\"});case 2:case\"end\":return _context7.stop();}}},_callee7);}));return function DeletePost(_x9,_x10){return _ref7.apply(this,arguments);};}();export var SendMessage=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(token,POST_ID,content){var _yield$apiCall6,success,error,data;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return apiCall(\"posts/\".concat(POST_ID,\"/messages\"),{token:token,method:\"POST\",body:{message:{content:content}}});case 2:_yield$apiCall6=_context8.sent;success=_yield$apiCall6.success;error=_yield$apiCall6.error;data=_yield$apiCall6.data;if(error){console.log(error);}case 7:case\"end\":return _context8.stop();}}},_callee8);}));return function SendMessage(_x11,_x12,_x13){return _ref8.apply(this,arguments);};}();","map":{"version":3,"names":["BASEURL","makeHeaders","token","headers","apiCall","endpoint","defaultOptions","method","body","options","JSON","stringify","console","log","fetch","response","json","result","fetchPosts","success","error","data","posts_value","posts","registerUser","username","password","user","mesage","message","logInUser","alert","isLoggedIn","CreatePost","post","fetchUser","userResponse","DeletePost","POST_ID","SendMessage","content"],"sources":["/home/ahc/Bootcamp2022UBUNTU/course_work/NewStrangersThings/StrangersThings/src/api/Requests.js"],"sourcesContent":["\nconst BASEURL = \"https://strangers-things.herokuapp.com/api/2207-FTB-ET-WEB-PT\";\n\n\n\n\nconst makeHeaders = (token) => {\n  const headers = {\n    \"Content-Type\": \"application/json\",\n  };\n\n  if (token) {\n    headers['Authorization'] = `Bearer ${token}`;\n  }\n//  console.log(headers);\n  return headers;\n};\n\nexport const apiCall = async (endpoint, defaultOptions= {}) => {\n  const {token, method, body} = defaultOptions;\n  \n  const options = {};\n  options.headers = makeHeaders(token);\n  if (method) {\n    options.method = method;\n  };\n  if (body) {\n    options.body = JSON.stringify(body);\n  }\n  console.log(\"body in apiCall\", options.body);\n  //  console.log(\"options in apiCall\", options);\n    const response = await fetch(`${BASEURL}/${endpoint}`, options);\n    const result = await response.json();\n    return result;\n}\n\nexport const fetchPosts = async (token = null)=> {\n  const {success, error, data} = await apiCall('posts', {token:token, method:\"GET\"});\n//  console.log(\"data: \", data.posts);\n  if (success) {\n   // console.log(\"success! in fetchPosts()\");\n    return {\n      error: null,\n      posts_value: data.posts\n    }\n  } else {\n  //  console.log(\"failure :( in fetchPosts()\")\n    return {\n      error: \"Failed to Load apiCall in fetchPosts\",\n      posts_value: []\n    }\n  }\n}\n\nexport const registerUser = async (username, password) => {\n  try {\n    const {success, error, data} = await apiCall('users/register', {token: null, method: \"Post\", body: {user: {username: username,\n    password: password}}} );\n    if (success) {\n  //    console.log(username, data.token)\n      return {\n        error: null,\n        token: data.token,\n        mesage: data.message\n      }\n    } else {\n     // console.log(\"no success in registerUser()\", error);\n      return {\n        error: error.message,\n        token: null,\n        message: null\n      }\n    }\n  } catch (error){\n    console.error(error);\n    return {\n      error: \"error in registeredUser() call\",\n      token: null,\n      message: null\n    }\n  }\n}\n\nexport const logInUser = async (username, password) => {\n  try {\n    const {success, error, data} = await apiCall('users/login', {token: null, method: \"Post\", body: {user: {username: username,\n    password: password}}} );\n    if (success) {\n     // console.log(username, data.token)\n      return {\n        error: null,\n        token: data.token,\n        mesage: data.message\n      }\n    } else {\n      alert(\"Incorrect User Credentials\");\n     // console.log(\"no success in registerUser()\", error);\n      return {\n        error: error.message,\n        token: null,\n        message: null\n      }\n    }\n  } catch (error){\n    console.error(error);\n    return {\n      error: \"error in registeredUser() call\",\n      token: null,\n      message: null\n    }\n  }\n}\n\nexport const isLoggedIn = (token = null) => {\n  if (token) {return true} else {\n    return false\n  }\n}\n\nexport const CreatePost = async (token, post) => {\n  try {\n    const {success, error, data} = await apiCall('posts', {token: token, method: \"Post\", body: {post: post}} );\n    if (success) {\n      return {\n        error: null,\n        post: data.post,\n        mesage: data.message\n      }\n    } else {\n     // console.log(\"error in CreatePost\", error.message);\n      return {\n        error: error.message,\n        post: null,\n        message: null\n      }\n    }\n  } catch (error){\n    console.error(error);\n    return {\n      error: \"error in CreatePost() call\",\n      post: null,\n      message: null\n    }\n  }\n}\n\nexport const fetchUser = async (token) => {\n  try {\n  //  console.log(\"fetchUser() called\");\n    const {success, error, data} = await apiCall('users/me', {token:token});\n  //  console.log(\"fetchUser() data\", data);\n    if (success) {\n      return {\n        error: null,\n        userResponse: data,\n        mesage: data.message\n      }\n    } else {\n      return {\n        error: error.message,\n        userResponse: null,\n        message: null\n      }\n    }\n  } catch (error){\n    console.error(error);\n    return {\n      error: \"error in FetchUser() call\",\n      userResponse: null,\n      message: null\n    }\n  }\n}\n\nexport const DeletePost = async (token, POST_ID) => {\n // console.log(\"DeletePost() called\");\n  await apiCall(`posts/${POST_ID}`, {token:token, method: \"DELETE\"});\n   \n}\n\nexport const SendMessage = async (token, POST_ID, content) => {\n  //console.log(\"SendMessage() called\");\n  //console.log(content);\n  const {success, error, data} = await apiCall(`posts/${POST_ID}/messages`, {token: token, method: \"POST\", body: {message:{ content: content}}})\n  if (error) {\n    console.log(error);\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}